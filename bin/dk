#!/usr/bin/env ruby

require 'rubygems'
# require 'tumblr_draftking'
require_relative '../lib/tumblr_draftking'

case ARGV[0]
when '--version', '-v'
  puts DK::Client.version
when '--help', '-h', nil
  puts DK::CLI.dk_help
when 'setup'
  DK::DkConfig.setup
when 'console'
  DK::DkConfig.setup unless DK::DkConfig.configured?
  DK::CLI.launch_console
else
  DK::DkConfig.setup unless DK::DkConfig.configured?
  command, opts = DK::CLI.process_opts(ARGV)
  abort("Invalid command: #{command}") unless DK::DkConfig.command_valid?(command)
  # puts opts
  dk = DK::Client.new(opts)
  case command
  when 'blogs'         # List blog names
    dk.list_blogs
  when 'comment'       # Comment
    dk.comment_posts(opts)
  when 'c_and_m'       # Comment and Move
    dk.drafts_to_queue(opts)
    dk.status
  when 'move_drafts'   # Move Drafts
    opts[:caption] = ''
    dk.drafts_to_queue(opts)
  when 'status'        # Drafts, Queue sizes
    dk.status
  when 'strip'         # Strip old comments
    dk.strip_old_comments(opts)
  end
end
